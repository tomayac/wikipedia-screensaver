"use strict";!function(e){function n(n,t){var r=e.createEvent("Event");r.initEvent(n,!0,!1),t.dispatchEvent(r)}function t(t){t.stopPropagation(),t.stopImmediatePropagation(),e[a.enabled]=e[s.enabled],e[a.element]=e[s.element],n(a.events.change,t.target)}function r(e){n(a.events.error,e.target)}function i(n){return function(t,r){function i(){t(),e.removeEventListener(s.events.change,i,!1)}function l(){r(new TypeError),e.removeEventListener(s.events.error,l,!1)}return n!==a.exit||e[s.element]?(e.addEventListener(s.events.change,i,!1),void e.addEventListener(s.events.error,l,!1)):void setTimeout(function(){r(new TypeError)},1)}}var s,l,c=!0,o={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},a=o.w3;for(l in o)if(o[l].enabled in e){s=o[l];break}return!c||a.enabled in e||!s||(e.addEventListener(s.events.change,t,!1),e.addEventListener(s.events.error,r,!1),e[a.enabled]=e[s.enabled],e[a.element]=e[s.element],e[a.exit]=function(){var n=e[s.exit]();return!n&&Promise?new Promise(i(a.exit)):n},Element.prototype[a.request]=function(){var e=this[s.request].apply(this,arguments);return!e&&Promise?new Promise(i(a.request)):e}),s}(document),function(e,n,t,r){var i="https://stream.wikimedia.org:443/rc",s=9,l=n("#tiles-container"),c=n("#sound"),o=n("#fullscreen"),a={},u=0,d=function(e){return 0===Object.keys(e).length&&JSON.stringify(e)===JSON.stringify({})},m=function(e){var n={};return speechSynthesis.getVoices().filter(function(n){return!e||/^Google/.test(n.name)}).map(function(e){n[e.lang.substr(0,2)]=e}),n},v=function(e){var n=e.wiki.replace("wiki","");e.language=n;var t=a[n]||!1;d(a)?h(e,n):t&&g.forEach(function(n){return n(e,t)})},f=function(e,n){setTimeout(function(){if(!speechSynthesis.speaking&&!speechSynthesis.pending){var t=new SpeechSynthesisUtterance;t.addEventListener("start",function(){h(e,n.lang)}),t.text=e.title,n&&(t.voice=n),c.checked?t.volume=100:t.volume=0,speechSynthesis.speak(t)}},0)},h=function(e,n){var r=Math.floor,i=Math.random,c=t("div");c.className="tile",c.style.backgroundColor=("rgb(\n        "+r(255*i())+",\n        "+r(255*i())+",\n        "+r(255*i())+")").replace(/\n/g,"").replace(/\s/g,"");var o=t("img");o.src="img/"+n.split("-")[0]+".svg",o.className="flag",c.appendChild(o);var a=t("a");a.className="label",a.textContent=""+e.title,a.href=e.server_url+"/wiki/"+e.title.replace(/ /g,"_"),a.target="_blank",c.appendChild(a),l.children.length>s-1&&l.firstChild.remove();var d=Math.floor(Math.random()*(s-1));d===u&&(d=(d+1)%s),u=d,l.insertBefore(c,l.children.item(d))},g=[f];!function(){e.fullscreenEnabled?o.addEventListener("change",function(){o.checked?e.body.requestFullscreen():e.exitFullscreen()}):(o.remove(),n('label[for="fullscreen"]').remove());var t=r.connect(i);t.on("connect",function(){t.emit("subscribe","*")}),t.on("change",function(e){"edit"===e.type&&e.bot===!1&&0===e.namespace&&"wikidatawiki"!==e.wiki&&v(e)}),c.addEventListener("click",function(){var e=new SpeechSynthesisUtterance("Click");speechSynthesis.speak(e),a=m(!0),d(a)&&(a=m(!1)),speechSynthesis.onvoiceschanged=function(){a=m(!0),d(a)&&(a=m(!1))}}),a=m(!0),d(a)&&(a=m(!1)),speechSynthesis.onvoiceschanged=function(){a=m(!0),d(a)&&(a=m(!1))}}()}(document,document.querySelector.bind(document),document.createElement.bind(document),window.io);