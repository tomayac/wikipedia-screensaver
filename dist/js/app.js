"use strict";!function(r){var l,e,n={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},i=n.w3;for(e in n)if(n[e].enabled in r){l=n[e];break}function t(e,n){var t=r.createEvent("Event");t.initEvent(e,!0,!1),n.dispatchEvent(t)}function c(e){return function(n,t){e!==i.exit||r[l.element]?(r.addEventListener(l.events.change,function e(){n(),r.removeEventListener(l.events.change,e,!1)},!1),r.addEventListener(l.events.error,function e(){t(new TypeError),r.removeEventListener(l.events.error,e,!1)},!1)):setTimeout(function(){t(new TypeError)},1)}}i.enabled in r||!l||(r.addEventListener(l.events.change,function(e){e.stopPropagation(),e.stopImmediatePropagation(),r[i.enabled]=r[l.enabled],r[i.element]=r[l.element],t(i.events.change,e.target)},!1),r.addEventListener(l.events.error,function(e){t(i.events.error,e.target)},!1),r[i.enabled]=r[l.enabled],r[i.element]=r[l.element],r[i.exit]=function(){var e=r[l.exit]();return!e&&Promise?new Promise(c(i.exit)):e},Element.prototype[i.request]=function(){var e=this[l.request].apply(this,arguments);return!e&&Promise?new Promise(c(i.request)):e})}(document),function(e,n,l,a){var o=l("#tiles-container"),i=l("#sound"),c=l("#fullscreen"),s={},u=0,d=function(e){return 0===Object.keys(e).length&&JSON.stringify(e)===JSON.stringify({})},m=function(n){var t={};return speechSynthesis.getVoices().filter(function(e){return!n||/^Google/.test(e.name)}).map(function(e){t[e.lang.substr(0,2)]=e}),t},v=function(e,n){var t=Math.floor,r=Math.random,l=a("div");l.className="tile",l.style.backgroundColor=("rgb(\n        "+t(255*r())+",\n        "+t(255*r())+",\n        "+t(255*r())+")").replace(/\n/g,"").replace(/\s/g,"");var i=a("img");i.src="img/"+n.split("-")[0]+".svg",i.className="flag",l.appendChild(i);var c=a("a");c.className="label",c.textContent=""+e.title,c.href=e.server_url+"/wiki/"+e.title.replace(/ /g,"_"),c.target="_blank",l.appendChild(c),8<o.children.length&&o.firstChild.remove();var s=Math.floor(8*Math.random());s===u&&(s=(s+1)%9),u=s,o.insertBefore(l,o.children.item(s))},f=[function(n,t){setTimeout(function(){if(!speechSynthesis.speaking&&!speechSynthesis.pending){var e=new SpeechSynthesisUtterance;e.addEventListener("start",function(){v(n,t.lang)}),e.text=n.title,t&&(e.voice=t),i.checked?e.volume=100:e.volume=0,speechSynthesis.speak(e)}},0)}];!function(){if(e.fullscreenEnabled?c.addEventListener("change",function(){c.checked?e.body.requestFullscreen():e.exitFullscreen()}):(c.remove(),l('label[for="fullscreen"]').remove()),new EventSource("https://stream.wikimedia.org/v2/stream/recentchange").onmessage=function(e){var n=JSON.parse(e.data);"edit"!==n.type||n.bot||0!==n.namespace||"wikidatawiki"===n.wiki||function(n){var e=n.wiki.replace("wiki","");n.language=e;var t=s[e]||!1;d(s)?v(n,e):t&&f.forEach(function(e){return e(n,t)})}(n)},i.addEventListener("click",function(){var e=new SpeechSynthesisUtterance(i.checked?"Sound on":"Sound off");speechSynthesis.speak(e),s=m(!0),d(s)&&(s=m(!1)),speechSynthesis.onvoiceschanged=function(){s=m(!0),d(s)&&(s=m(!1))}}),"getWakeLock"in n){var t=l("#keep-awake");t.style.display="block",t.labels[0].style.display="block";var r=null;n.getWakeLock("screen").then(function(e){r=e;var n=null;t.addEventListener("click",function(){return function(){if(n)return n.cancel(),n=null;n=r.createRequest()}(),console.log("Wake lock is "+(r.active?"active":"not active"))})}).catch(function(e){return console.error("Could not obtain wake lock",e)})}}()}(document,navigator,document.querySelector.bind(document),document.createElement.bind(document));